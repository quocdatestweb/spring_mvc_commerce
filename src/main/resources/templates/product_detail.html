<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head th:replace="fragments/header.html :: header(${pageTitle})">
<body>
<header th:replace="fragments/head.html :: head()">
</header>
<section class="hero">
    <div class="container">
        <div class="row">
            <div class="col-lg-3">
                <div class="hero__categories">
                    <div class="hero__categories__all">
                        <i class="fa fa-bars"></i>
                        <span>Tất cả thể loại</span>
                    </div>
                    <ul id="productTableBody">

                    </ul>

                </div>
            </div>
            <div class="col-lg-9">
                <div class="hero__search">
                    <div class="hero__search__form">
                        <form th:action="@{/products}">
                            <input  name="keyword" type="text" th:value="${keyword}" placeholder="Bạn cần tìm gì?" required>
                            <button type="submit" class="site-btn">Tìm kiếm</button>
                        </form>
                    </div>
                    <div class="hero__search__phone">
                        <div class="hero__search__phone__icon">
                            <i class="fa fa-phone"></i>
                        </div>
                        <div class="hero__search__phone__text">
                            <h5>+8491228445</h5>
                            <span>Hỗ trợ 24/7 </span>
                        </div>
                    </div>
                </div>
                <div class="hero__item set-bg" th:data-setbg="@{/img/hero/banner.jpg}" th:style="'background-image: url(\'' + @{/img/hero/banner.jpg} + '\');'">
                    <div class="hero__text">
                        <span>Black Friday 2023 sắp trở lại</span>
                        <h2>Chính sách đổi trả <br> bảo hành tốt nhất</h2>
                        <p>Nhận và giao hàng miễn phí</p>
                        <a href="#" class="primary-btn">MUA NGAY</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<section class="product-details spad" th:object="${product}">
    <div class="container">
        <div class="row">
            <div class="col-lg-6 col-md-6" >
                <div class="product__details__pic">
                    <div class="product__details__pic__item">
                        <img class="product__details__pic__item--large" th:src="*{image}"  alt="">
                    </div>
                    <div class="product__details__pic__slider owl-carousel owl-loaded owl-drag">
                        <div class="owl-stage-outer"><div class="owl-stage" style="transform: translate3d(-795px, 0px, 0px); transition: all 0s ease 0s; width: 1590px;"><div class="owl-item cloned" style="width: 112.5px; margin-right: 20px;"><img data-imgbigurl="img/product/details/product-details-2.jpg" src="img/product/details/thumb-1.jpg" alt=""></div><div class="owl-item cloned" style="width: 112.5px; margin-right: 20px;"><img data-imgbigurl="img/product/details/product-details-3.jpg" src="img/product/details/thumb-2.jpg" alt=""></div><div class="owl-item cloned" style="width: 112.5px; margin-right: 20px;"><img data-imgbigurl="img/product/details/product-details-5.jpg" src="img/product/details/thumb-3.jpg" alt=""></div><div class="owl-item cloned" style="width: 112.5px; margin-right: 20px;"><img data-imgbigurl="img/product/details/product-details-4.jpg" src="img/product/details/thumb-4.jpg" alt=""></div><div class="owl-item" style="width: 112.5px; margin-right: 20px;"><img data-imgbigurl="img/product/details/product-details-2.jpg" src="img/product/details/thumb-1.jpg" alt=""></div><div class="owl-item" style="width: 112.5px; margin-right: 20px;"><img data-imgbigurl="img/product/details/product-details-3.jpg" src="img/product/details/thumb-2.jpg" alt=""></div><div class="owl-item active" style="width: 112.5px; margin-right: 20px;"><img data-imgbigurl="img/product/details/product-details-5.jpg" src="img/product/details/thumb-3.jpg" alt=""></div><div class="owl-item active" style="width: 112.5px; margin-right: 20px;"><img data-imgbigurl="img/product/details/product-details-4.jpg" src="img/product/details/thumb-4.jpg" alt=""></div><div class="owl-item cloned active" style="width: 112.5px; margin-right: 20px;"><img data-imgbigurl="img/product/details/product-details-2.jpg" src="img/product/details/thumb-1.jpg" alt=""></div><div class="owl-item cloned active" style="width: 112.5px; margin-right: 20px;"><img data-imgbigurl="img/product/details/product-details-3.jpg" src="img/product/details/thumb-2.jpg" alt=""></div><div class="owl-item cloned" style="width: 112.5px; margin-right: 20px;"><img data-imgbigurl="img/product/details/product-details-5.jpg" src="img/product/details/thumb-3.jpg" alt=""></div><div class="owl-item cloned" style="width: 112.5px; margin-right: 20px;"><img data-imgbigurl="img/product/details/product-details-4.jpg" src="img/product/details/thumb-4.jpg" alt=""></div></div></div><div class="owl-nav disabled"><button type="button" role="presentation" class="owl-prev"><span aria-label="Previous">‹</span></button><button type="button" role="presentation" class="owl-next"><span aria-label="Next">›</span></button></div><div class="owl-dots disabled"><button role="button" class="owl-dot active"><span></span></button></div></div>
                </div>
            </div>
            <div class="col-lg-6 col-md-6">
                <div class="product__details__text">
                    <h3 th:text="*{name}"></h3>
                    <div class="product__details__rating">
                        <i class="fa fa-star"></i>
                        <i class="fa fa-star"></i>
                        <i class="fa fa-star"></i>
                        <i class="fa fa-star"></i>
                        <i class="fa fa-star-half-o"></i>
                        <span>(18 lượt xem)</span>
                    </div>
                    <div class="product__details__price">[[*{price}]] VND</div>
                    <p th:text="*{description}"></p>
                    <!-- add to cart -->
                    <form th:action="@{/cart/add}" th:object="${cartItem}" method="post">
                        <div class="form-group">
                            <div class="product__details__quantity">
                                <div class="quantity">
                                    <div class="pro-qty">
                                        <input type="number" id="quantity" name="quantity" min="1"
                                               value="1" >
                                    </div>
                                </div>
                            </div>

                            <input type="hidden" name="productId" th:value="${product.id}" />
                            <input type="hidden" name="productPrice" th:value="${product.price}" />
<!--                            <input style="width: 80px" class="form-control" type="number" id="quantity" name="quantity" min="1"-->
<!--                                   value="1" />-->
                            <button type="submit" class="primary-btn">
                                THÊM VÀO GIỎ HÀNG
                            </button>
                        </div>
                    </form>
                    <ul>
                        <li><b>Loại sản phẩm</b> <span>[[*{category}]]</span></li>
                    </ul>
                </div>
            </div>
            <div class="col-lg-12">
                <div class="product__details__tab">
                    <ul class="nav nav-tabs" role="tablist">
                        <li class="nav-item">
                            <h1><a class="nav-link active" data-toggle="tab" href="#tabs-1" role="tab" aria-selected="true">Mô tả</a></h1>
                        </li>
                    </ul>
                    <div class="tab-content">
                        <div class="tab-pane active" id="tabs-1" role="tabpanel">
                            <div class="product__details__tab__desc">
                                <h6>Thông tin sản phẩm</h6>
                                <p th:text="*{description}"></p>

                            </div>
                        </div>
                        <div class="tab-pane" id="tabs-2" role="tabpanel">
                            <div class="product__details__tab__desc">
                                <h6>Thông tin sản phẩm</h6>
                                <p>- Bổ sung 32 loại rau xanh, củ quả
                                    - Cung cấp các dưỡng chất cần thiết cho cơ thể
                                    - Bổ sung thêm 1000 tỉ lợi khuẩn và men tiêu hoá
                                    - Dành cho những người bận rộn, không có thời gian ăn uống đủ dưỡng chất
                                    - Giúp tránh : nóng người, táo bón, nổi mụn,...
                                    - Có tác dụng thanh nhiệt, giải khát
                                    - Dùng được cho phụ nữ có thai
                                    -  Phù hợp cho những người đang ăn kiêng

                                    *** Viên rau củ quả Nhật Bản bổ sung 32 loại rau xanh, củ quả và nhiều dưỡng chất cơ bản cần thiết cho cơ thể.

                                    *** Dành cho những ai bận rộn không có thời gian ăn uống đủ chất, hay những bạn ghét và lười ăn rau, tránh được nhiều căn bệnh như nóng người, nổi mụn, táo bón…

                                    *** Viên rau củ quả với đầy đủ các thành phần dưỡng chất từ : bột lúa mạch, cải xoăn ,một số loại rau màu xanh lá cây: lúa mạch non, cải xoăn, cà rốt, cà chua, khoai lang, hành tây, bí ngô,...

                                    *** Cách sử dụng viên rau củ Premium
                                    *** Uống 4 viên/ 1 ngày
                                    *** Có thể chia nhỏ hoặc uống cùng 1 lúc
                                    *** Uống sau khi ăn</p>
                            </div>
                        </div>
                        <div class="tab-pane" id="tabs-3" role="tabpanel">
                            <div class="product__details__tab__desc">
                                <h6>Thông tin sản phẩm</h6>
                                <p>- Bổ sung 32 loại rau xanh, củ quả
                                    - Cung cấp các dưỡng chất cần thiết cho cơ thể
                                    - Bổ sung thêm 1000 tỉ lợi khuẩn và men tiêu hoá
                                    - Dành cho những người bận rộn, không có thời gian ăn uống đủ dưỡng chất
                                    - Giúp tránh : nóng người, táo bón, nổi mụn,...
                                    - Có tác dụng thanh nhiệt, giải khát
                                    - Dùng được cho phụ nữ có thai
                                    -  Phù hợp cho những người đang ăn kiêng

                                    *** Viên rau củ quả Nhật Bản bổ sung 32 loại rau xanh, củ quả và nhiều dưỡng chất cơ bản cần thiết cho cơ thể.

                                    *** Dành cho những ai bận rộn không có thời gian ăn uống đủ chất, hay những bạn ghét và lười ăn rau, tránh được nhiều căn bệnh như nóng người, nổi mụn, táo bón…

                                    *** Viên rau củ quả với đầy đủ các thành phần dưỡng chất từ : bột lúa mạch, cải xoăn ,một số loại rau màu xanh lá cây: lúa mạch non, cải xoăn, cà rốt, cà chua, khoai lang, hành tây, bí ngô,...

                                    *** Cách sử dụng viên rau củ Premium
                                    *** Uống 4 viên/ 1 ngày
                                    *** Có thể chia nhỏ hoặc uống cùng 1 lúc
                                    *** Uống sau khi ăn</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<div th:if="${isAdmin}" class="row justify-content-center text-center my-2">
    <div class="col-md-8 col-lg-6">
        <div class="header">
            <h2>Manage Products</h2>
        </div>
        <div class="m-2">
            <a class="btn btn-lg btn-primary" th:href="@{/products/new}">
                Add New Product
            </a>
        </div>
    </div>
</div>
</div>



<!-- row filter -->
<!--<div class="container mb-4">-->
<!--  <div class="row gap-2">-->
<!--    <div class="col btn btn-lg btn-primary">-->
<!--      <th th:replace="fragments/filter :: filter('category','Category')"> </th>-->
<!--    </div>-->
<!--    <div class="col btn btn-lg btn-primary">-->
<!--      <th th:replace="fragments/filter :: filter('name','Name')"> </th>-->
<!--    </div>-->
<!--    <div class="col btn btn-lg btn-primary">-->
<!--      <th th:replace="fragments/filter :: filter('price','Price')"> </th>-->
<!--    </div>-->
<!--    <div class="col btn btn-lg btn-primary">-->
<!--      <th th:replace="fragments/filter :: filter('brand','Brand')"> </th>-->
<!--    </div>-->
<!--    <div class="col btn btn-lg btn-primary">-->
<!--      <th th:replace="fragments/filter :: filter('color','Color')"> </th>-->
<!--    </div>-->
<!--  </div>-->
<!--</div>-->

<!-- Table for admin -->
<div th:if="${isAdmin}" class="container">
    <!-- table result -->
    <div class="container-fluid text-center">

        <div th:if="${message}" class="alert alert-success text-center">
            [[${message}]]
        </div>

        <div>
            <table class="table table-bordered table-hover">
                <thead class="thead-dark">
                <tr>
                    <th class="col" th:replace="fragments/filter :: filter('id','Id')"> </th>
                    <th class="col" th:replace="fragments/filter :: filter('image','Image')"> </th>
                    <th class="col" th:replace="fragments/filter :: filter('category','Category')"> </th>
                    <th class="col" th:replace="fragments/filter :: filter('name','Name')"> </th>
                    <th class="col" th:replace="fragments/filter :: filter('price','Price')"> </th>
                    <th class="col" th:replace="fragments/filter :: filter('brand','Brand')"> </th>
                    <th class="col" th:replace="fragments/filter :: filter('color','Color')"> </th>
                    <th class="col">Handler</th>
                </tr>
                </thead>
                <tbody>
                <th:block th:each="product, idx : ${paginatedProductResponse.products}">
                    <tr th:classappend="${idx.index % 2 == 0} ? 'table-active' : 'table-light'">
                        <td class="align-middle vertical-center">
                            <a th:href="@{/products/} + ${product.id}">
                                [[${product.id}]]
                            </a>
                        </td>
                        <td>
                            <img style="object-fit: cover;" width="100" height="100"
                                 th:src="${product.image != null ? product.image : 'https://placehold.co/100x100/png'}" alt="">
                        </td>
                        <td class="align-middle vertical-center text-truncate">[[${product.category}]]</td>
                        <td class="align-middle vertical-center text-truncate">[[${product.name}]]</td>
                        <td class="align-middle vertical-center text-truncate">[[${product.price}]]</td>
                        <td class="align-middle vertical-center text-truncate">[[${product.brand}]]</td>
                        <td class="align-middle vertical-center text-truncate">[[${product.color}]]</td>
                        <td class="align-middle">
                            <a class="h4 p-1" th:href="@{'/products/edit/' + ${product.id}}">
                                <i class="fa-solid fa-pen-to-square"></i>
                            </a>

                            <a class="h4 p-1" th:href="@{'/products/delete/' + ${product.id}}">
                                <i class="fa-solid fa-trash"></i>
                            </a>

                            <a class="h4 p-1" th:href="@{'/products/' + ${product.id}}">
                                <i class="fa-solid fa-eye"></i>
                            </a>
                        </td>
                    </tr>
                </th:block>

                </tbody>
            </table>



        </div>
    </div>
</div>
    <!-- footer -->
    <footer th:replace="fragments/footer.html :: footer()">
    </footer>
</div>

<!-- script -->
<script type="text/javascript">
    function clearSearch() {
        window.location = "[[@{/products}]]";
    }
</script>
<script>
    $(document).ready(function() {
        $.getJSON("/api/category", function(products) {
            var tableBody = $("#productTableBody");
            var uniqueCategories = [];

            $.each(products, function(index, product) {
                var category = product.category;
                if (!uniqueCategories.includes(category)) {
                    uniqueCategories.push(category);
                    var row = "<li><a>" + category + "</a></li>";
                    tableBody.append(row);
                }
            });
        });
    });
</script>


</body>

</html>